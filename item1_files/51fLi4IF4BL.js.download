(function(w){var q=window.AmazonUIPageJS||window.P,n=q._namespace||q.attributeErrors,H=n?n("VSECommonComponentAssets",""):q;H.guardFatal?H.guardFatal(w)(H,window):H.execute(function(){w(H,window)})})(function(w,q,n){(function(){function H(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})}function ba(a){return a}function ma(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,
c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function Cb(a,b,c){b=Ca(b===n?a.length-1:b,0);return function(){for(var e=arguments,h=-1,k=Ca(e.length-b,0),g=Array(k);++h<k;)g[h]=e[b+h];h=-1;for(k=Array(b+1);++h<b;)k[h]=e[h];k[b]=c(g);return ma(a,this,k)}}function Db(a){return function(){return a}}function P(a){if(null==a)return a===n?"[object Undefined]":"[object Null]";if(Da&&Da in Object(a)){var b=Eb.call(a,V),c=a[V];try{a[V]=n;var e=!0}catch(k){}var h=Fb.call(a);e&&(b?a[V]=
c:delete a[V]);a=h}else a=Gb.call(a);return a}function F(a){var b=typeof a;return null!=a&&("object"==b||"function"==b)}function Ea(a){if(!F(a))return!1;a=P(a);return"[object Function]"==a||"[object GeneratorFunction]"==a||"[object AsyncFunction]"==a||"[object Proxy]"==a}function I(a){if(null!=a){try{return Hb.call(a)}catch(b){}return a+""}return""}function J(a,b){a=null==a?n:a[b];b=!F(a)||Fa&&Fa in a?!1:(Ea(a)?Ib:Jb).test(I(a));return b?a:n}function Ga(a){var b=0,c=0;return function(){var e=Kb(),
h=16-(e-c);c=e;if(0<h){if(800<=++b)return arguments[0]}else b=0;return a.apply(n,arguments)}}function W(a){return function(){var b=arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=na(a.prototype),b=a.apply(c,b);
return F(b)?b:c}}function Lb(a,b,c){function e(){return(this&&this!==z&&this instanceof e?k:a).apply(h?c:this,arguments)}var h=b&1,k=W(a);return e}function Ha(a,b,c,e){var h=-1,k=a.length,g=c.length,f=-1,d=b.length,v=Mb(k-g,0),m=Array(d+v);for(e=!e;++f<d;)m[f]=b[f];for(;++h<g;)if(e||h<k)m[c[h]]=a[h];for(;v--;)m[f++]=a[h++];return m}function Ia(a,b,c,e){var h=-1,d=a.length,g=-1,f=c.length,l=-1,v=b.length,m=Nb(d-f,0),n=Array(m+v);for(e=!e;++h<m;)n[h]=a[h];for(m=h;++l<v;)n[m+l]=b[l];for(;++g<f;)if(e||
h<d)n[m+c[g]]=a[h++];return n}function oa(){}function Q(a){this.__wrapped__=a;this.__actions__=[];this.__dir__=1;this.__filtered__=!1;this.__iteratees__=[];this.__takeCount__=4294967295;this.__views__=[]}function Ob(){}function R(a,b){this.__wrapped__=a;this.__actions__=[];this.__chain__=!!b;this.__index__=0;this.__values__=n}function K(a){return null!=a&&"object"==typeof a}function Ja(a,b){var c=-1,e=a.length;for(b||(b=Array(e));++c<e;)b[c]=a[c];return b}function ca(a){if(K(a)&&!x(a)&&!(a instanceof
Q)){if(a instanceof R)return a;if(Pb.call(a,"__wrapped__")){if(a instanceof Q)a=a.clone();else{var b=new R(a.__wrapped__,a.__chain__);b.__actions__=Ja(a.__actions__);b.__index__=a.__index__;b.__values__=a.__values__;a=b}return a}}return new R(a)}function Qb(a,b){for(var c=-1,e=null==a?0:a.length;++c<e&&!1!==b(a[c],c,a););return a}function Rb(a,b){Qb(Sb,function(c){var e="_."+c[0];if(c=b&c[1]){if(c=null==a?0:a.length){if(e===e)a:{c=-1;for(var h=a.length;++c<h;)if(a[c]===e)break a;c=-1}else a:{c=a.length;
for(h=-1;++h<c;){var d=a[h];if(d!==d){c=h;break a}}c=-1}c=-1<c}c=!c}c&&a.push(e)});return a.sort()}function Ka(a,b,c){b+="";var e;e=(e=b.match(Tb))?e[1].split(Ub):[];c=Rb(e,c);if(e=c.length){var h=e-1;c[h]=(1<e?"\x26 ":"")+c[h];c=c.join(2<e?", ":" ");b=b.replace(Vb,"{\n/* [wrapped with "+c+"] */\n")}return La(a,b)}function Ma(a,b,c,e,h,d,g,f,l,v){var m=b&8,y=m?g:n;g=m?n:g;var r=m?d:n;d=m?n:d;b=(b|(m?32:64))&~(m?64:32);b&4||(b&=-4);h=[a,b,h,r,y,d,g,f,l,v];c=c.apply(n,h);b:for(f=a.name+"",l=Na[f],v=
Wb.call(Na,f)?l.length:0;v--;)if(m=l[v],y=m.func,null==y||y==a){f=m.name;break b}l=ca[f];"function"==typeof l&&f in Q.prototype?a===l?f=!0:(f=Oa(l),f=!!f&&a===f[0]):f=!1;f&&Pa(c,h);c.placeholder=e;return Ka(c,a,b)}function pa(a,b){b=null==b?9007199254740991:b;return!!b&&("number"==typeof a||Xb.test(a))&&-1<a&&0==a%1&&a<b}function X(a,b){for(var c=-1,e=a.length,h=0,d=[];++c<e;){var g=a[c];if(g===b||"__lodash_placeholder__"===g)a[c]="__lodash_placeholder__",d[h++]=c}return d}function qa(a,b,c,e,h,d,
g,f,l,v){function m(){for(var q=arguments.length,A=Array(q),E=q;E--;)A[E]=arguments[E];if(t){var L=m.placeholder,S,E=A.length;for(S=0;E--;)A[E]===L&&++S}e&&(A=Ha(A,e,h,t));d&&(A=Ia(A,d,g,t));q-=S;if(t&&q<v)return L=X(A,L),Ma(a,b,qa,m.placeholder,c,A,L,f,l,v-q);L=r?c:this;E=p?L[a]:a;q=A.length;if(f){S=A.length;for(var w=Yb(f.length,S),x=Ja(A);w--;){var B=f[w];A[w]=pa(B,S)?x[B]:n}}else Zb&&1<q&&A.reverse();y&&l<q&&(A.length=l);this&&this!==z&&this instanceof m&&(E=u||W(E));return E.apply(L,A)}var y=
b&128,r=b&1,p=b&2,t=b&24,Zb=b&512,u=p?n:W(a);return m}function $b(a,b,c){function e(){for(var d=arguments.length,g=Array(d),f=d,l=e.placeholder;f--;)g[f]=arguments[f];f=3>d&&g[0]!==l&&g[d-1]!==l?[]:X(g,l);d-=f.length;return d<c?Ma(a,b,qa,e.placeholder,n,g,f,n,n,c-d):ma(this&&this!==z&&this instanceof e?h:a,this,g)}var h=W(a);return e}function ac(a,b,c,e){function h(){for(var b=-1,l=arguments.length,v=-1,m=e.length,n=Array(m+l),r=this&&this!==z&&this instanceof h?g:a;++v<m;)n[v]=e[v];for(;l--;)n[v++]=
arguments[++b];return ma(r,d?c:this,n)}var d=b&1,g=W(a);return h}function da(a){return"symbol"==typeof a||K(a)&&"[object Symbol]"==P(a)}function bc(a){if("number"==typeof a)return a;if(da(a))return Qa;F(a)&&(a="function"==typeof a.valueOf?a.valueOf():a,a=F(a)?a+"":a);if("string"!=typeof a)return 0===a?a:+a;a=a.replace(cc,"");var b=dc.test(a);return b||ec.test(a)?fc(a.slice(2),b?2:8):gc.test(a)?Qa:+a}function Ra(a){a?(a=bc(a),a=a===Sa||a===-Sa?1.7976931348623157E308*(0>a?-1:1):a===a?a:0):a=0===a?a:
0;var b=a%1;return a===a?b?a-b:a:0}function hc(a,b,c,e){for(var h=-1,d=null==a?0:a.length;++h<d;){var g=a[h];b(e,g,c(g),a)}return e}function Ta(a){return K(a)&&"[object Arguments]"==P(a)}function ic(){return!1}function ra(a){return"number"==typeof a&&-1<a&&0==a%1&&9007199254740991>=a}function jc(a){return K(a)&&ra(a.length)&&!!u[P(a)]}function kc(a){return function(b){return a(b)}}function Ua(a){return null!=a&&ra(a.length)&&!Ea(a)}function ea(a){if(Ua(a)){var b=x(a),c=!b&&Va(a),e=!b&&!c&&sa(a),h=
!b&&!c&&!e&&Wa(a);if(b=b||c||e||h){for(var c=a.length,d=String,g=-1,f=Array(c);++g<c;)f[g]=d(g);c=f}else c=[];var d=c.length,l;for(l in a)!lc.call(a,l)||b&&("length"==l||e&&("offset"==l||"parent"==l)||h&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||pa(l,d))||c.push(l);a=c}else if(l=a&&a.constructor,a===("function"==typeof l&&l.prototype||mc)){l=[];for(e in Object(a))nc.call(a,e)&&"constructor"!=e&&l.push(e);a=l}else a=oc(a);return a}function pc(a,b,c,e){qc(a,function(a,d,g){b(e,a,c(a),g)});return e}
function Xa(a,b){return a===b||a!==a&&b!==b}function fa(a,b){for(var c=a.length;c--;)if(Xa(a[c][0],b))return c;return-1}function B(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var e=a[b];this.set(e[0],e[1])}}function M(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var e=a[b];this.set(e[0],e[1])}}function ga(a,b){a=a.__data__;var c=typeof b;return("string"==c||"number"==c||"symbol"==c||"boolean"==c?"__proto__"!==b:null===b)?a["string"==typeof b?"string":"hash"]:a.map}function D(a){var b=
-1,c=null==a?0:a.length;for(this.clear();++b<c;){var e=a[b];this.set(e[0],e[1])}}function C(a){this.size=(this.__data__=new B(a)).size}function ha(a){var b=-1,c=null==a?0:a.length;for(this.__data__=new D;++b<c;)this.add(a[b])}function rc(a,b){for(var c=-1,e=null==a?0:a.length;++c<e;)if(b(a[c],c,a))return!0;return!1}function Ya(a,b,c,e,h,d){var g=c&1,f=a.length,l=b.length;if(f!=l&&!(g&&l>f))return!1;if((l=d.get(a))&&d.get(b))return l==b;var l=-1,v=!0,m=c&2?new ha:n;d.set(a,b);for(d.set(b,a);++l<f;){var y=
a[l],r=b[l];if(e)var p=g?e(r,y,l,b,a,d):e(y,r,l,a,b,d);if(p!==n){if(p)continue;v=!1;break}if(m){if(!rc(b,function(a,b){if(!m.has(b)&&(y===a||h(y,a,c,e,d)))return m.push(b)})){v=!1;break}}else if(y!==r&&!h(y,r,c,e,d)){v=!1;break}}d["delete"](a);d["delete"](b);return v}function sc(a){var b=-1,c=Array(a.size);a.forEach(function(a,h){c[++b]=[h,a]});return c}function tc(a){var b=-1,c=Array(a.size);a.forEach(function(a){c[++b]=a});return c}function uc(a,b,c,e,h,d,g){switch(c){case "[object DataView]":if(a.byteLength!=
b.byteLength||a.byteOffset!=b.byteOffset)break;a=a.buffer;b=b.buffer;case "[object ArrayBuffer]":if(a.byteLength!=b.byteLength||!d(new Za(a),new Za(b)))break;return!0;case "[object Boolean]":case "[object Date]":case "[object Number]":return Xa(+a,+b);case "[object Error]":return a.name==b.name&&a.message==b.message;case "[object RegExp]":case "[object String]":return a==b+"";case "[object Map]":var f=sc;case "[object Set]":f||(f=tc);if(a.size!=b.size&&!(e&1))break;if(c=g.get(a))return c==b;e|=2;
g.set(a,b);b=Ya(f(a),f(b),e,h,d,g);g["delete"](a);return b;case "[object Symbol]":if(ta)return ta.call(a)==ta.call(b)}return!1}function $a(a,b,c){b=b(a);if(!x(a)){a=c(a);c=-1;for(var e=a.length,h=b.length;++c<e;)b[h+c]=a[c]}return b}function vc(a,b){for(var c=-1,e=null==a?0:a.length,h=0,d=[];++c<e;){var g=a[c];b(g,c,a)&&(d[h++]=g)}return d}function wc(){return[]}function T(a,b,c,e,d){if(a===b)return!0;if(null==a||null==b||!K(a)&&!K(b))return a!==a&&b!==b;a:{var k=x(a),g=x(b),f=k?"[object Array]":
ab(a),l=g?"[object Array]":ab(b),f="[object Arguments]"==f?"[object Object]":f,l="[object Arguments]"==l?"[object Object]":l,v="[object Object]"==f,g="[object Object]"==l;if((l=f==l)&&sa(a)){if(!sa(b)){b=!1;break a}k=!0;v=!1}if(l&&!v)d||(d=new C),b=k||Wa(a)?Ya(a,b,c,e,T,d):uc(a,b,f,c,e,T,d);else{if(!(c&1)&&(k=v&&bb.call(a,"__wrapped__"),f=g&&bb.call(b,"__wrapped__"),k||f)){a=k?a.value():a;b=f?b.value():b;d||(d=new C);b=T(a,b,c,e,d);break a}if(l)b:if(d||(d=new C),k=c&1,f=$a(a,ea,cb),g=f.length,l=$a(b,
ea,cb).length,g==l||k){for(v=g;v--;){var m=f[v];if(!(k?m in b:xc.call(b,m))){b=!1;break b}}if((l=d.get(a))&&d.get(b))b=l==b;else{l=!0;d.set(a,b);d.set(b,a);for(var y=k;++v<g;){var m=f[v],r=a[m],p=b[m];if(e)var t=k?e(p,r,m,b,a,d):e(r,p,m,a,b,d);if(t===n?r!==p&&!T(r,p,c,e,d):!t){l=!1;break}y||(y="constructor"==m)}l&&!y&&(c=a.constructor,e=b.constructor,c!=e&&"constructor"in a&&"constructor"in b&&!("function"==typeof c&&c instanceof c&&"function"==typeof e&&e instanceof e)&&(l=!1));d["delete"](a);d["delete"](b);
b=l}}else b=!1;else b=!1}}return b}function yc(a,b,c,e){var d=c.length,k=d,g=!e;if(null==a)return!k;for(a=Object(a);d--;){var f=c[d];if(g&&f[2]?f[1]!==a[f[0]]:!(f[0]in a))return!1}for(;++d<k;){var f=c[d],l=f[0],v=a[l],m=f[1];if(g&&f[2]){if(v===n&&!(l in a))return!1}else{f=new C;if(e)var p=e(v,m,l,a,b,f);if(p===n?!T(m,v,3,e,f):!p)return!1}}return!0}function zc(a){for(var b=ea(a),c=b.length;c--;){var e=b[c],d=a[e];b[c]=[e,d,d===d&&!F(d)]}return b}function db(a,b){return function(c){return null==c?!1:
c[a]===b&&(b!==n||a in Object(c))}}function Ac(a){var b=zc(a);return 1==b.length&&b[0][2]?db(b[0][0],b[0][1]):function(c){return c===a||yc(c,a,b)}}function ua(a,b){if(x(a))return!1;var c=typeof a;return"number"==c||"symbol"==c||"boolean"==c||null==a||da(a)?!0:Bc.test(a)||!Cc.test(a)||null!=b&&a in Object(b)}function va(a,b){if("function"!=typeof a||null!=b&&"function"!=typeof b)throw new TypeError("Expected a function");var c=function(){var e=arguments,d=b?b.apply(this,e):e[0],k=c.cache;if(k.has(d))return k.get(d);
e=a.apply(this,e);c.cache=k.set(d,e)||k;return e};c.cache=new (va.Cache||D);return c}function eb(a){if("string"==typeof a)return a;if(x(a)){for(var b=-1,c=null==a?0:a.length,e=Array(c);++b<c;)e[b]=eb(a[b],b,a);return e+""}if(da(a))return fb?fb.call(a):"";b=a+"";return"0"==b&&1/a==-Dc?"-0":b}function gb(a,b){return x(a)?a:ua(a,b)?[a]:Ec(null==a?"":eb(a))}function ia(a){if("string"==typeof a||da(a))return a;var b=a+"";return"0"==b&&1/a==-Fc?"-0":b}function hb(a,b){b=gb(b,a);for(var c=0,e=b.length;null!=
a&&c<e;)a=a[ia(b[c++])];return c&&c==e?a:n}function Gc(a,b){return ua(a)&&b===b&&!F(b)?db(ia(a),b):function(c){var e;e=null==c?n:hb(c,a);e=e===n?void 0:e;var d;if(e===n&&e===b){if(e=null!=c){e=a;e=gb(e,c);for(var k=-1,g=e.length,f=!1;++k<g;){d=ia(e[k]);if(!(f=null!=c&&null!=c&&d in Object(c)))break;c=c[d]}f||++k!=g?e=f:(g=null==c?0:c.length,e=!!g&&ra(g)&&pa(d,g)&&(x(c)||Va(c)))}d=e}else d=T(b,e,3);return d}}function Hc(a){return function(b){return null==b?n:b[a]}}function Ic(a){return function(b){return hb(b,
a)}}q.vseFeatures=q.vseFeatures||{};var ib=q.gatedP||{register:function(a,b,c,e,d){void 0===d&&(d=q.vseFeatures);w.now(a).execute(a+"-prereg",function(k){k||d[b]||(d[b]=!0,e.resolve(c(e)).then(function(){w.now(a).execute(a+"-reg",function(c){c||(w.log("Gated registration failed to register module!","ERROR",a),d[b]=!1)})}))})},declare:function(a,b,c,e){void 0===e&&(e=q.vseFeatures);w.now(a).execute(a+"-prereg",function(d){d||e[b]||(e[b]=!0,w.declare(a,c))})}},N={count:function(a,b){var c=q.ue;c&&c.count("vse:csm:"+
a,b)},emitSushiMetric:function(a,b,c){var e=this;b=b||"https://unagi-na.amazon.com/1/events/com.amazon.eel.vse.metricstest.nexus";c=c||0;if(!(3<=c)){var d=JSON.stringify(a).replace(/\\\\/g,""),k={params:d,paramsFormat:"json",contentType:"application/json; charset\x3dutf-8",error:function(){e.emitSushiMetric(a,b,++c)}},g=navigator.userAgent.match(/iPhone/i),f=!1;w.now("mash").execute("vse-detect-mshop",function(){f=!0});var l=null!==g&&f;w.when("A").execute("Emit-VSE-Metrics",function(a){navigator&&
navigator.sendBeacon&&!l?navigator.sendBeacon(b,d):a.post(b,k)})}}},Jc={makeApplicationSushiPayloadBuilder:function(a,b){return function(c){var e={eventSource:b.eventSource,requestId:b.requestId,sessionId:b.sessionId,placementContext:b.placementContext,marketplaceId:b.marketplaceId,weblabIds:b.weblabIds,clientId:b.clientId,isInternal:b.isInternal.toString(),isRobot:b.isRobot.toString(),pageAsin:b.pageAsin,customerId:b.customerId,sessionType:b.sessionType||1,refMarkers:b.refMarkers,eventId:H(),timestamp:new Date,
userAgentData:navigator.userAgent,titleSessionId:0,videoAsin:0};return{events:[{data:a.$.extend(e,c)}]}}}},Kc={fetchLatestPageState:function(a,b){a.state.replace(b,JSON.parse(a.$("script[type\x3d'a-state'][data-a-state*\x3d"+b+"]").html()));return a.state(b)}},Lc=function(a,b){return b={exports:{}},a(b,b.exports),b.exports}(function(a){function b(){}function c(a,b,c){this.fn=a;this.context=b;this.once=c||!1}function e(){this._events=new b;this._eventsCount=0}var d=Object.prototype.hasOwnProperty,
k="~";Object.create&&(b.prototype=Object.create(null),(new b).__proto__||(k=!1));e.prototype.eventNames=function(){var a=[],b,c;if(0===this._eventsCount)return a;for(c in b=this._events)d.call(b,c)&&a.push(k?c.slice(1):c);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(b)):a};e.prototype.listeners=function(a,b){a=this._events[k?k+a:a];if(b)return!!a;if(!a)return[];if(a.fn)return[a.fn];b=0;for(var c=a.length,e=Array(c);b<c;b++)e[b]=a[b].fn;return e};e.prototype.emit=function(a,
b,c,e,d,h){var r=k?k+a:a;if(!this._events[r])return!1;var r=this._events[r],p=arguments.length,t,q;if(r.fn){r.once&&this.removeListener(a,r.fn,n,!0);switch(p){case 1:return r.fn.call(r.context),!0;case 2:return r.fn.call(r.context,b),!0;case 3:return r.fn.call(r.context,b,c),!0;case 4:return r.fn.call(r.context,b,c,e),!0;case 5:return r.fn.call(r.context,b,c,e,d),!0;case 6:return r.fn.call(r.context,b,c,e,d,h),!0}q=1;for(t=Array(p-1);q<p;q++)t[q-1]=arguments[q];r.fn.apply(r.context,t)}else{var u=
r.length,w;for(q=0;q<u;q++)switch(r[q].once&&this.removeListener(a,r[q].fn,n,!0),p){case 1:r[q].fn.call(r[q].context);break;case 2:r[q].fn.call(r[q].context,b);break;case 3:r[q].fn.call(r[q].context,b,c);break;case 4:r[q].fn.call(r[q].context,b,c,e);break;default:if(!t)for(w=1,t=Array(p-1);w<p;w++)t[w-1]=arguments[w];r[q].fn.apply(r[q].context,t)}}return!0};e.prototype.on=function(a,b,e){b=new c(b,e||this);a=k?k+a:a;this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],b]:this._events[a].push(b):
(this._events[a]=b,this._eventsCount++);return this};e.prototype.once=function(a,b,e){b=new c(b,e||this,!0);a=k?k+a:a;this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],b]:this._events[a].push(b):(this._events[a]=b,this._eventsCount++);return this};e.prototype.removeListener=function(a,c,e,d){a=k?k+a:a;if(!this._events[a])return this;if(!c)return 0===--this._eventsCount?this._events=new b:delete this._events[a],this;var h=this._events[a];if(h.fn)h.fn!==c||d&&!h.once||e&&h.context!==
e||(0===--this._eventsCount?this._events=new b:delete this._events[a]);else{for(var n=0,p=[],q=h.length;n<q;n++)(h[n].fn!==c||d&&!h[n].once||e&&h[n].context!==e)&&p.push(h[n]);p.length?this._events[a]=1===p.length?p[0]:p:0===--this._eventsCount?this._events=new b:delete this._events[a]}return this};e.prototype.removeAllListeners=function(a){a?(a=k?k+a:a,this._events[a]&&(0===--this._eventsCount?this._events=new b:delete this._events[a])):(this._events=new b,this._eventsCount=0);return this};e.prototype.off=
e.prototype.removeListener;e.prototype.addListener=e.prototype.on;e.prototype.setMaxListeners=function(){return this};e.prefixed=k;e.EventEmitter=e;"undefined"!==typeof a&&(a.exports=e)}).EventEmitter,Mc=function(){function a(a,c){void 0===c&&(c={refTagRecorderEndPoint:"/gp/mobile/tag/",retryLimit:3});this.A=a;this.config=c}a.prototype.emitRefTag=function(a,c,e){void 0===e&&(e=0);if(!(e>=this.config.retryLimit)){var d=this;this.A.post(this.config.refTagRecorderEndPoint+"ref\x3d"+a+(c.enableAssociateTag?
"?tag\x3dospatk-20\x26linkCode\x3dvse\x26creativeASIN\x3d"+c.productAsin+"\x26ascsubtag\x3d"+c.contentId:""),{error:function(){d.emitRefTag(a,c,++e)}})}};return a}(),p=function(){function a(){}a.POSITIVE_VOTE="positive";a.NEGATIVE_VOTE="negative";a.NONE_VOTE="none";a.EMPTY_VOTE="";return a}(),jb=function(){function a(a,c){this.element=a;this.videoVoteConfig=c;this.positiveVoteCount=0;this.showPositiveVotes=!1;this.negativeVoteCount=0;this.showNegativeVotes=!1;this.prompt=a.find(".vse-vote-helpful-text");
this.positiveVoteText=a.find(".vse-vote-positive");this.positiveVoteIcon=a.find(".vse-vote-positive-icon");this.negativeVoteText=a.find(".vse-vote-negative");this.negativeVoteIcon=a.find(".vse-vote-negative-icon");this.previousVote=p.EMPTY_VOTE}a.prototype.getVoteCount=function(a){return a===p.POSITIVE_VOTE?this.positiveVoteCount:a===p.NEGATIVE_VOTE?this.negativeVoteCount:0};a.prototype.setVoteCount=function(a,c){0>c&&(c=0);a===p.POSITIVE_VOTE?(this.positiveVoteCount=c,this.positiveVoteText.html(String(c))):
a===p.NEGATIVE_VOTE&&(this.negativeVoteCount=c,this.negativeVoteText.html(String(c)))};a.prototype.getPreviousVote=function(){return this.previousVote};a.prototype.setPreviousVote=function(a){if(a===p.POSITIVE_VOTE)this.positiveVoteIcon.addClass("hasvoted"),this.negativeVoteIcon.removeClass("hasvoted"),0>=this.getVoteCount(p.POSITIVE_VOTE)&&this.setVoteCount(p.POSITIVE_VOTE,1);else if(a===p.NEGATIVE_VOTE)this.negativeVoteIcon.addClass("hasvoted"),this.positiveVoteIcon.removeClass("hasvoted"),0>=this.getVoteCount(p.NEGATIVE_VOTE)&&
this.setVoteCount(p.NEGATIVE_VOTE,1);else if(a===p.NONE_VOTE)this.negativeVoteIcon.removeClass("hasvoted"),this.positiveVoteIcon.removeClass("hasvoted");else return;this.previousVote=a};a.prototype.setContentId=function(a){this.contentId=a};a.prototype.getContentId=function(){return this.contentId};a.prototype.showOrHide=function(a,c,e,d){this.showPositiveVotes=a;this.showNegativeVotes=c;this.showPrompt=e;a?(this.positiveVoteText.addClass("show"),this.positiveVoteIcon.addClass("show")):(this.positiveVoteText.removeClass("show"),
this.positiveVoteIcon.removeClass("show"));c?(this.negativeVoteText.addClass("show"),this.negativeVoteIcon.addClass("show")):(this.negativeVoteText.removeClass("show"),this.negativeVoteIcon.removeClass("show"));e?this.prompt.addClass("show"):this.prompt.removeClass("show");d?this.element.addClass("show"):this.element.removeClass("show")};a.prototype.updateWithNewVote=function(a){if(a===p.POSITIVE_VOTE||a===p.NEGATIVE_VOTE){var c=a==p.POSITIVE_VOTE?p.NEGATIVE_VOTE:p.POSITIVE_VOTE,e=this.getVoteCount(a),
d=this.getVoteCount(c);a===this.getPreviousVote()?(this.setPreviousVote(p.NONE_VOTE),this.setVoteCount(a,e-1)):this.getPreviousVote()!==p.EMPTY_VOTE&&this.getPreviousVote()!==p.NONE_VOTE?(this.setVoteCount(c,d-1),this.setVoteCount(a,e+1),this.setPreviousVote(a)):(this.setPreviousVote(a),this.setVoteCount(a,e+1))}};return a}(),Nc=function(){return function(a,b,c){this.contentId=a;this.positiveVoteCount=b;this.negativeVoteCount=c}}(),kb=function(){return function(a){this.name="InvalidArugmentsException";
this.message=a}}(),lb=function(){function a(a,c){this.A=a;this.videoVoteConfig=c}a.prototype.createFromContent=function(a,c){a=this.A.$("#"+a).find("[.vse-video-votes][data-contentid\x3d"+c+"]");return new jb(a,this.videoVoteConfig)};a.prototype.createFromSelector=function(a){var c=this.A.$(""+a);if(!c)throw new kb("VideoVoteContainerFactory can not find selector by the name of "+a+".");return new jb(c,this.videoVoteConfig)};a.prototype.sendVoteToRemote=function(a,c,e){var d=this,k={contentId:e,placement:this.videoVoteConfig.placementContext,
positive:a,negative:c,requestId:this.videoVoteConfig.requestId,sessionId:this.videoVoteConfig.sessionId,page:this.videoVoteConfig.page,experimentWeblab:this.videoVoteConfig.experimentWeblab};return new this.videoVoteConfig.dependencies.promise(function(a,b){d.A.ajax("/vap/ew/subcomponent/votes/writing",{params:k,paramsFormat:"json",crossDomain:!0,method:"POST",contentType:"application/json",success:function(b){a(b)},error:function(a){N.count("votecast:failed",1);b(a)}})})};a.prototype.fetchVoteHistory=
function(a){var c=this,e={contentId:a,placement:this.videoVoteConfig.placementContext,requestId:this.videoVoteConfig.requestId,sessionId:this.videoVoteConfig.sessionId,page:this.videoVoteConfig.page,experimentWeblab:this.videoVoteConfig.experimentWeblab};return new this.videoVoteConfig.dependencies.promise(function(a,b){c.A.ajax("/vap/ew/subcomponent/votes/status",{params:e,paramsFormat:"json",crossDomain:!0,method:"POST",contentType:"application/json",success:function(b){a(b)},error:function(a){N.count("votehistory:failed",
1);b(a)}})})};a.prototype.convertPayloadToVoteData=function(a){var c=[],e;for(e in a)a.hasOwnProperty(e)&&c.push(new Nc(e,a[e].positive,a[e].negative));return c};a.prototype.fetchVoteCounts=function(a){var c=this,e={contentIds:a,placement:this.videoVoteConfig.placementContext,requestId:this.videoVoteConfig.requestId,sessionId:this.videoVoteConfig.sessionId,page:this.videoVoteConfig.page,experimentWeblab:this.videoVoteConfig.experimentWeblab};return new this.videoVoteConfig.dependencies.promise(function(a,
b){c.A.ajax("/vap/ew/subcomponent/votes",{params:e,paramsFormat:"json",crossDomain:!0,method:"POST",contentType:"application/json",success:function(e){e=c.convertPayloadToVoteData(e);0<e.length&&a(e);b(e)},error:function(a){N.count("votegetcounts:failed",1);b(a)}})})};return a}(),Oc=function(){function a(a,c,e,d,k){var g=this;this.carouselFramework=c;this.A=e;this.contentCarouselConfig=d;this.deps=k;this.vseAssets=[];this.voteContainerIndex={};this.carouselPageSize=0;this.carouselPageNumber=1;var f=
e.$;this.activeCard=f([]);var l=this;this.auiCarousel=a;this.refTagRecorder=new Mc(e);f("#"+d.carouselName).find(".a-carousel-heading").after(f("#"+d.carouselName).find(".vse-upload-link").removeClass("aok-hidden"));f("#"+d.carouselName+" .vse-video-item").each(function(){l.vseAssets.push(l.getAssetSpec(f(this)))});this.vseAssetIndex=this.deps._keyBy(this.vseAssets,"contentId");d.videoVoteConfig&&(this.videoVoteContainerFactory=new lb(e,d.videoVoteConfig),e.each(this.vseAssetIndex,function(a){g.voteContainerIndex[a.contentId]=
g.videoVoteContainerFactory.createFromContent(g.contentCarouselConfig.carouselName,a.contentId);a.videoVoteContainer=g.voteContainerIndex[a.contentId]}));d.showAdPlacement||f("#"+d.carouselName).delegate(".a-carousel-card a","click",function(a){if(f(this).closest("li").hasClass("active"))a.preventDefault();else{var b=l.vseAssetIndex[f(this).closest("li").find(".vse-video-item").data("asin")];l.markPlaying(b);b.eventTimestamp=Date.now();e.trigger("vse:contentCarousel:"+d.carouselName+":click",b);var c=
l.findIndex(b);l.emitRefTag(c,l.contentCarouselConfig.refTagPrefix,b);d.isPreventDefault&&a.preventDefault()}});f("#"+d.carouselName+" .vse-carousel-item").each(function(a){var b=f(this);if(d.showAdPlacement){b.attr("href",b.data("redirect-url")+"?ref\x3ddp_vse_rva1_pc");var c=b.parent().data("asin");b.parent().delegate(".vse-carousel-item","click",function(a){e.trigger("vse:rva:carousel:"+d.carouselName+":productClick",{relatedProductAsin:c,name:"vse.related_video_advertising.productClick"})})}else b.attr("href",
b.data("redirect-url")+"?ref\x3d"+l.contentCarouselConfig.refTagPrefix+a)});e.off("a:carousel:"+d.carouselName+":change:pageSize");e.off("a:carousel:"+d.carouselName+":change:pageNumber");e.on("a:carousel:"+d.carouselName+":change:pageSize",function(){g.carouselPageSize=g.auiCarousel.getAttr("pageSize");g.activeAsset&&g.rotateTo(g.activeAsset)});e.trigger("a:carousel:"+d.carouselName+":change:pageSize");e.on("a:carousel:"+d.carouselName+":change:pageNumber",function(){g.carouselPageNumber=g.auiCarousel.getAttr("pageNumber");
e.trigger("a:carousel:"+d.carouselName+":scrollCarousel",g.carouselPageNumber,g.carouselPageSize)});e.trigger("a:carousel:"+d.carouselName+":updatePageIndex",this.carouselPageNumber,this.carouselPageSize)}a.prototype.getplaylist=function(){return this.vseAssets.slice()};a.prototype.getActiveAsset=function(){return this.activeAsset};a.prototype.scrollTo=function(){this.A.$("#"+this.contentCarouselConfig.carouselName).animate({scrollTop:this.activeCard.offset().top-this.A.$("#"+this.contentCarouselConfig.carouselName).offset().top+
this.A.$("#"+this.contentCarouselConfig.carouselName).scrollTop()})};a.prototype.rotateTo=function(a){this.markPlaying(a);this.contentCarouselConfig.isVerticalScroll&&this.scrollTo();0!==this.carouselPageSize&&(a=this.findIndex(a),-1!==a&&(a=Math.floor(a/this.carouselPageSize)+1,this.carouselPageNumber!=a&&this.auiCarousel.gotoPage(a)))};a.prototype.changeStartingCardTo=function(a){var c=this;this.listOffset=this.findIndex(a);if(!this.contentCarouselConfig.isVerticalScroll){this.carouselFramework.initializeAll();
this.carouselFramework.onInit(""+this.contentCarouselConfig.carouselName,function(){c.rotateTo(a)});var e=this;this.A.$("#"+this.contentCarouselConfig.carouselName+" .vse-carousel-item").each(function(a){var b=e.A.$(this);a=(a-e.listOffset+e.vseAssets.length)%e.vseAssets.length;b.attr("href",b.data("redirect-url")+"?ref\x3d"+e.contentCarouselConfig.refTagPrefix+a)})}};a.prototype.markPlaying=function(a){this.activeAsset=a;this.activeCard.removeClass("active");this.activeCard=this.vseAssetIndex[a.contentId].$el.closest("li").addClass("active")};
a.prototype.findIndex=function(a){return this.vseAssets.indexOf(this.vseAssetIndex[a.contentId])};a.prototype.emitRefTag=function(a,c,e){0<this.listOffset&&(a=(a-this.listOffset+this.vseAssets.length)%this.vseAssets.length);this.refTagRecorder.emitRefTag(c+a,e)};a.prototype.destroy=function(){this.A.$("#"+this.contentCarouselConfig.carouselName+" .a-carousel-card.active").removeClass("active")};a.prototype.updateVotingElements=function(a,c){var e=this;this.A.each(a,function(a){var b=e.vseAssetIndex[a.contentId].videoVoteContainer;
b.setVoteCount(p.POSITIVE_VOTE,a.positiveVoteCount);b.setVoteCount(p.NEGATIVE_VOTE,a.negativeVoteCount);b.showOrHide(c,c,!1,c)})};a.prototype.getAssetSpec=function(a){var c=a.data(),e=a.find(".vse-video-image").data("img"),e=e.replace("SR160,90_BG0,0,0_PKvse-overlay-play2","").replace("SR320,180_BG0,0,0_PKvse-overlay-play2","");return{contentId:c.asin,title:c.title,vendorName:c.vendorName,vendorCode:c.vendorCode,referenceUrl:c.referenceUrl,referenceLinkTitle:c.referenceTitle,videoUrl:c.videoUrl,$el:a,
duration:c.duration,imageUrl:e,sponsored:c.sponsored,enableAssociateTag:c.enableAssociateTag,videoVoteContainer:this.voteContainerIndex[c.asin],productAsin:c.productAsin}};return a}(),Pc=function(){function a(a,c,e){this.carouselFramework=a;this.A=c;this.deps=e}a.prototype.create=function(a){var c=this.carouselFramework.getCarousel(this.A.$("#"+a.carouselName));if(!c)throw new kb("Carousel framework can not find carousel by the name of "+a.carouselName+".");return new Oc(c,this.carouselFramework,
this.A,a,this.deps)};return a}(),U=function(){function a(){}a.ELM_OTHER_OPTION=".vse-fb-other";a.ELM_RBTN_CHECKED='input[name\x3d"FeedbackInput"]:checked';a.ELM_CHECKBOX_CHECKED='input[type\x3d"checkbox"]:checked';a.DATA_REQ_MSG="requiredcommentmessage";a.DATA_OPTIONAL_MSG="optionalcommentmessage";a.ATTR_NAME_PLACEHOLDER="placeholder";return a}(),mb=n;w.when("a-sheet").execute(function(a){mb=a});var Qc={getBottomSheet:function(){return mb}},Rc=function(){function a(a){var c=this;this.config=a;this.activeVideoSource=
this.activeVideo="VIDEO_NOT_SELECTED";this.isOtherSelected=this.registered=!1;this.setBottomSheetHeight=!0;this.internalRejectedVideo=this.suppressDefaultAnimation=!1;this._submitErrorCallback=function(a){c.A.trigger("vse:"+c.id+":feedback:submitted:error")};this._submitSuccessCallback=function(a){c.A.trigger("vse:"+c.id+":feedback:submitted:success")};this.A=a.A;this.pageStateName=a.pageStateName;this.buttonApi=a.buttonApi;this.id=this.config.id;this.A.state.parse();this.A.state.replace(this.pageStateName,
JSON.parse(this.A.$("script[type\x3d'a-state'][data-a-state*\x3d"+this.pageStateName+"]").html()));a=this.A.state(this.pageStateName);this.feedbackSection=this.A.$("#"+this.id);this.feedbackForm=this.A.$("#"+this.id+"-form");this.commentBox=this.A.$("#"+this.id+"-comment-box");this.requiredCommentMessage=this.commentBox.parent().data(U.DATA_REQ_MSG);this.optionalCommentMessage=this.commentBox.parent().data(U.DATA_OPTIONAL_MSG);this.thankYouSection=this.A.$("#"+this.id+"-ty-container");this.submitButton=
this.buttonApi("#"+this.id+"-btn-submit");this.cancelButton=this.A.$("#"+this.id+"-btn-cancel");a&&this.validateFormElements()&&(this.isMobile=a.isMobile,this.endpoint=a.feedbackEndpoint,this.isInternal=a.isInternal,this.marketplaceId=a.marketplaceId,this.pageAsin=a.pageAsin,this.customerId=a.customerId,this.bottomSheetFactory=Qc.getBottomSheet(),this.registered||(this.A.declarative(this.id+"-options-choose","click",function(a){c.activeSelectionEvent=a;c.A.$(a)&&c.A.$(a.$target)&&(c.currentViolations=
c.A.$(a.$target).closest(".vse-fb-option").find("input").val());c.otherSection=a.$target.closest(U.ELM_OTHER_OPTION);1===c.otherSection.length?(c.updatePlaceholderString(c.requiredCommentMessage),c.isOtherSelected=!0):(c.isOtherSelected=!1,c.updatePlaceholderString(c.optionalCommentMessage));c.submitButton.enable()}),this.A.declarative(this.id+"-andoncord-check","change",function(a){c.internalRejectedVideo=a.$target.is(":checked")}),this.A.declarative(this.id+"-btn-close","click",function(){return c.cancelFeedbackForm()}),
this.A.declarative(this.id+"-btn-cancel","click",function(){return c.cancelFeedbackForm()}),this.A.declarative(this.id+"-btn-submit","click",function(){return c.submitFeedback()}),this.A.on("a:sheet:afterShow:"+this.id+"-sheet",function(a){c.A.trigger("vse:"+c.id+":feedback:shown");c.changeBottomSheetHeight(a)}),this.A.on("a:sheet:afterHide:"+this.id+"-sheet",function(a){c.A.trigger("vse:"+c.id+":feedback:hidden");c.hideThankYou()}),this.registered=!0))}a.prototype.showFeedbackForm=function(a){var c=
this;if(a)return this.suppressDefaultAnimation=a,this.A.trigger("vse:"+this.id+":feedback:shown"),this;this.isMobile||this.feedbackSection.slideDown("slow",function(){c.A.trigger("vse:"+c.id+":slide-down:completed")});this.A.trigger("vse:"+this.id+":feedback:shown");return this};a.prototype.hideFeedbackForm=function(){var a=this;if(this.suppressDefaultAnimation)return this.A.trigger("vse:"+this.id+":feedback:hidden"),this;this.isMobile?(this.bottomSheetInstance=this.bottomSheetFactory.get(this.id+
"-sheet"),this.bottomSheetInstance.hide()):this.feedbackSection.slideUp("fast",function(){a.A.trigger("vse:"+a.id+":slide-up:completed");a.hideThankYou()});this.A.trigger("vse:"+this.id+":feedback:hidden");return this};a.prototype.setActiveVideoAndSource=function(a,c){this.activeVideo=a;this.activeVideoSource=c};a.prototype.submitFeedback=function(){if(this.isOtherSelected&&this.commentBox&&""===this.commentBox.val())this.commentBox.focus();else{var a={events:[{data:{feedback:{additionalComments:this.commentBox?
this.commentBox.val():"",playerVersion:"",asin:this.pageAsin,videoId:this.activeVideo,videoSource:this.activeVideoSource,violations:this.currentViolations,url:document.location.href,userAgent:q.navigator&&q.navigator.userAgent?q.navigator.userAgent:"window.navigator.userAgent not supported",feedbackTime:this.A.now(),customerId:this.customerId,isInternal:this.isInternal,feedbackWidgetVersion:"2",marketplace:this.marketplaceId,internalRejectedVideo:this.internalRejectedVideo}}}]};this.A.$.ajax({url:this.endpoint,
data:JSON.stringify(a),type:"POST",contentType:"application/json; charset\x3dutf-8",error:this._submitErrorCallback,success:this._submitSuccessCallback});this.A.trigger("vse:"+this.id+":feedback:submitted");this.resetFeedbackForm().showThankYou()}};a.prototype.cancelFeedbackForm=function(){this.resetFeedbackForm().hideFeedbackForm();this.A.trigger("vse:"+this.id+":feedback:cancelled")};a.prototype.resetFeedbackForm=function(){this.submitButton.disable();this.feedbackSection.find(U.ELM_RBTN_CHECKED).each(function(){this.checked=
!1});this.updatePlaceholderString(this.optionalCommentMessage);this.commentBox.val("");this.internalRejectedVideo=!1;this.feedbackSection.find(U.ELM_CHECKBOX_CHECKED).each(function(){this.checked=!1});return this};a.prototype.showThankYou=function(){var a=this;this.feedbackForm.fadeOut(200);this.thankYouSection.addClass("show").removeClass("aok-hidden").fadeIn(400);this.A.delay(function(){a.hideFeedbackForm()},3E3);this.A.trigger("vse:"+this.id+":thank-you:shown");return this};a.prototype.hideThankYou=
function(){this.feedbackForm.fadeIn(10);this.thankYouSection.addClass("aok-hidden").removeClass("show").fadeOut(10);this.A.trigger("vse:"+this.id+":thank-you:hidden");return this};a.prototype.validateFormElements=function(){return this.feedbackSection.length&&this.commentBox.length&&this.thankYouSection.length&&this.submitButton.size()&&this.cancelButton.length&&this.feedbackForm.length};a.prototype.updatePlaceholderString=function(a){this.commentBox.attr(U.ATTR_NAME_PLACEHOLDER,a)};a.prototype.changeBottomSheetHeight=
function(a){if(this.setBottomSheetHeight){var c=parseInt(a.sheet.$container.css("max-height"),10);a.sheet.changeHeight({duration:.2,height:c});this.setBottomSheetHeight=!1}};return a}(),Sc=function(){function a(a){this.config=a;this.feedbackWidgets={}}a.prototype.create=function(a,c){c=this.feedbackWidgets[a]||new Rc({id:a,pageStateName:c,A:this.config.A,buttonApi:this.config.buttonApi});return this.feedbackWidgets[a]=c};a.prototype.get=function(a){return this.feedbackWidgets[a]};return a}(),Ca=Math.max,
nb="object"==typeof global&&global&&global.Object===Object&&global,Tc="object"==typeof self&&self&&self.Object===Object&&self,z=nb||Tc||Function("return this")(),G=z.Symbol,ob=Object.prototype,Eb=ob.hasOwnProperty,Fb=ob.toString,V=G?G.toStringTag:n,Gb=Object.prototype.toString,Da=G?G.toStringTag:n,wa=z["__core-js_shared__"],Fa=function(){var a=/[^.]+$/.exec(wa&&wa.keys&&wa.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Hb=Function.prototype.toString,Jb=/^\[object .+?Constructor\]$/,Ib=RegExp("^"+
Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$\x26").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ja=function(){try{var a=J(Object,"defineProperty");a({},"",{});return a}catch(b){}}(),Kb=Date.now,La=Ga(ja?function(a,b){return ja(a,"toString",{configurable:!0,enumerable:!1,value:Db(b),writable:!0})}:ba),Y=J(z,"WeakMap"),ka=Y&&new Y,pb=ka?function(a,b){ka.set(a,b);return a}:ba,qb=Object.create,na=function(){function a(){}
return function(b){if(!F(b))return{};if(qb)return qb(b);a.prototype=b;b=new a;a.prototype=n;return b}}(),Mb=Math.max,Nb=Math.max;Q.prototype=na(oa.prototype);Q.prototype.constructor=Q;var Oa=ka?function(a){return ka.get(a)}:Ob,Na={},Wb=Object.prototype.hasOwnProperty;R.prototype=na(oa.prototype);R.prototype.constructor=R;var x=Array.isArray,Pb=Object.prototype.hasOwnProperty;ca.prototype=oa.prototype;ca.prototype.constructor=ca;var Pa=Ga(pb),Tb=/\{\n\/\* \[wrapped with (.+)\] \*/,Ub=/,? & /,Vb=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,
Sb=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],Xb=/^(?:0|[1-9]\d*)$/,Yb=Math.min,Uc=Math.min,Qa=0/0,cc=/^\s+|\s+$/g,gc=/^[-+]0x[0-9a-f]+$/i,dc=/^0b[01]+$/i,ec=/^0o[0-7]+$/i,fc=parseInt,Sa=1/0,rb=Math.max,xa=function(a,b){return La(Cb(a,b,ba),a+"")}(function(a,b){var c=X(b,xa.placeholder),e=a,d=32,k=n,g=b,f=c,l=void 0,p=void 0;b=d&2;if(!b&&"function"!=typeof e)throw new TypeError("Expected a function");a=g?g.length:
0;a||(d&=-97,g=f=n);l=l===n?l:rb(Ra(l),0);p=p===n?p:Ra(p);a-=f?f.length:0;if(d&64)var m=g,q=f,g=f=n;c=b?n:Oa(e);m=[e,d,k,g,f,m,q,void 0,l,p];if(c&&(k=m[1],e=c[1],d=k|e,q=128==e&&8==k||128==e&&256==k&&m[7].length<=c[8]||384==e&&c[7].length<=c[8]&&8==k,131>d||q)){e&1&&(m[2]=c[2],d|=k&1?0:4);if(k=c[3])q=m[3],m[3]=q?Ha(q,k,c[4]):k,m[4]=q?X(m[3],"__lodash_placeholder__"):c[4];if(k=c[5])q=m[5],m[5]=q?Ia(q,k,c[6]):k,m[6]=q?X(m[5],"__lodash_placeholder__"):c[6];(k=c[7])&&(m[7]=k);e&128&&(m[8]=null==m[8]?
c[8]:Uc(m[8],c[8]));null==m[9]&&(m[9]=c[9]);m[0]=c[0];m[1]=d}e=m[0];d=m[1];k=m[2];g=m[3];f=m[4];p=m[9]=m[9]===n?b?0:e.length:rb(m[9]-a,0);!p&&d&24&&(d&=-25);b=d&&1!=d?8==d||16==d?$b(e,d,p):32!=d&&33!=d||f.length?qa.apply(n,m):ac(e,d,k,g):Lb(e,d,k);return Ka((c?pb:Pa)(b,m),e,d)});xa.placeholder={};var Vc=function(a){return function(b,c,e){var d=-1,k=Object(b);e=e(b);for(var g=e.length;g--;){var f=e[a?g:++d];if(!1===c(k[f],f,k))break}return b}}(),sb=Object.prototype,Wc=sb.hasOwnProperty,Xc=sb.propertyIsEnumerable,
Va=Ta(function(){return arguments}())?Ta:function(a){return K(a)&&Wc.call(a,"callee")&&!Xc.call(a,"callee")},tb="object"==typeof exports&&exports&&!exports.nodeType&&exports,ub=tb&&"object"==typeof module&&module&&!module.nodeType&&module,vb=ub&&ub.exports===tb?z.Buffer:n,sa=(vb?vb.isBuffer:n)||ic,u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=
u["[object Uint32Array]"]=!0;u["[object Arguments]"]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u["[object Map]"]=u["[object Number]"]=u["[object Object]"]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1;var wb="object"==typeof exports&&exports&&!exports.nodeType&&exports,xb=wb&&"object"==typeof module&&module&&!module.nodeType&&module,ya=xb&&xb.exports===
wb&&nb.process,la;a:{try{la=ya&&ya.binding&&ya.binding("util");break a}catch(a){}la=void 0}var yb=la&&la.isTypedArray,Wa=yb?kc(yb):jc,lc=Object.prototype.hasOwnProperty,mc=Object.prototype,oc=function(a,b){return function(c){return a(b(c))}}(Object.keys,Object),nc=Object.prototype.hasOwnProperty,qc=function(a,b){return function(c,e){if(null==c)return c;if(!Ua(c))return a(c,e);for(var d=c.length,k=b?d:-1,g=Object(c);(b?k--:++k<d)&&!1!==e(g[k],k,g););return c}}(function(a,b){return a&&Vc(a,b,ea)}),
Yc=Array.prototype.splice;B.prototype.clear=function(){this.__data__=[];this.size=0};B.prototype["delete"]=function(a){var b=this.__data__;a=fa(b,a);if(0>a)return!1;a==b.length-1?b.pop():Yc.call(b,a,1);--this.size;return!0};B.prototype.get=function(a){var b=this.__data__;a=fa(b,a);return 0>a?n:b[a][1]};B.prototype.has=function(a){return-1<fa(this.__data__,a)};B.prototype.set=function(a,b){var c=this.__data__,e=fa(c,a);0>e?(++this.size,c.push([a,b])):c[e][1]=b;return this};var Z=J(z,"Map"),aa=J(Object,
"create"),Zc=Object.prototype.hasOwnProperty,$c=Object.prototype.hasOwnProperty;M.prototype.clear=function(){this.__data__=aa?aa(null):{};this.size=0};M.prototype["delete"]=function(a){a=this.has(a)&&delete this.__data__[a];this.size-=a?1:0;return a};M.prototype.get=function(a){var b=this.__data__;return aa?(a=b[a],"__lodash_hash_undefined__"===a?n:a):Zc.call(b,a)?b[a]:n};M.prototype.has=function(a){var b=this.__data__;return aa?b[a]!==n:$c.call(b,a)};M.prototype.set=function(a,b){var c=this.__data__;
this.size+=this.has(a)?0:1;c[a]=aa&&b===n?"__lodash_hash_undefined__":b;return this};D.prototype.clear=function(){this.size=0;this.__data__={hash:new M,map:new (Z||B),string:new M}};D.prototype["delete"]=function(a){a=ga(this,a)["delete"](a);this.size-=a?1:0;return a};D.prototype.get=function(a){return ga(this,a).get(a)};D.prototype.has=function(a){return ga(this,a).has(a)};D.prototype.set=function(a,b){var c=ga(this,a),e=c.size;c.set(a,b);this.size+=c.size==e?0:1;return this};C.prototype.clear=function(){this.__data__=
new B;this.size=0};C.prototype["delete"]=function(a){var b=this.__data__;a=b["delete"](a);this.size=b.size;return a};C.prototype.get=function(a){return this.__data__.get(a)};C.prototype.has=function(a){return this.__data__.has(a)};C.prototype.set=function(a,b){var c=this.__data__;if(c instanceof B){var e=c.__data__;if(!Z||199>e.length)return e.push([a,b]),this.size=++c.size,this;c=this.__data__=new D(e)}c.set(a,b);this.size=c.size;return this};ha.prototype.add=ha.prototype.push=function(a){this.__data__.set(a,
"__lodash_hash_undefined__");return this};ha.prototype.has=function(a){return this.__data__.has(a)};var Za=z.Uint8Array,zb=G?G.prototype:n,ta=zb?zb.valueOf:n,ad=Object.prototype.propertyIsEnumerable,Ab=Object.getOwnPropertySymbols,cb=Ab?function(a){if(null==a)return[];a=Object(a);return vc(Ab(a),function(b){return ad.call(a,b)})}:wc,xc=Object.prototype.hasOwnProperty,za=J(z,"DataView"),Aa=J(z,"Promise"),Ba=J(z,"Set"),bd=I(za),cd=I(Z),dd=I(Aa),ed=I(Ba),fd=I(Y),O=P;if(za&&"[object DataView]"!=O(new za(new ArrayBuffer(1)))||
Z&&"[object Map]"!=O(new Z)||Aa&&"[object Promise]"!=O(Aa.resolve())||Ba&&"[object Set]"!=O(new Ba)||Y&&"[object WeakMap]"!=O(new Y))O=function(a){var b=P(a);if(a=(a="[object Object]"==b?a.constructor:n)?I(a):"")switch(a){case bd:return"[object DataView]";case cd:return"[object Map]";case dd:return"[object Promise]";case ed:return"[object Set]";case fd:return"[object WeakMap]"}return b};var ab=O,bb=Object.prototype.hasOwnProperty,Cc=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Bc=/^\w*$/;va.Cache=
D;var gd=/^\./,hd=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,id=/\\(\\)?/g,Ec=function(a){a=va(a,function(a){500===b.size&&b.clear();return a});var b=a.cache;return a}(function(a){var b=[];gd.test(a)&&b.push("");a.replace(hd,function(a,e,d,k){b.push(d?k.replace(id,"$1"):e||a)});return b}),Dc=1/0,Bb=G?G.prototype:n,fb=Bb?Bb.toString:n,Fc=1/0,jd=function(a,b){return function(c,e){var d=x(c)?hc:pc,k=b?b():{};e="function"==typeof e?e:null==e?ba:
"object"==typeof e?x(e)?Gc(e[0],e[1]):Ac(e):ua(e)?Hc(ia(e)):Ic(e);return d(c,a,e,k)}}(function(a,b,c){"__proto__"==c&&ja?ja(a,c,{configurable:!0,enumerable:!0,value:b,writable:!0}):a[c]=b}),t=function(){function a(){}a.WIDTH_ASPECT_RATIO=1.77;a.EMPTY_STRING="";a.ibCarouselContainer="#vse-ib-rv";a.ibMetadata=".vse-ib-metadata";a.videoInformationContainer=".vse-md-container .vse-md-title";a.reviewStarContainer=".vse-md-container .vse-reviewstar-container";a.reviewTextContainer=".vse-md-container .vse-reviewText-container";
a.ceVideoElement="vse-content-experiment-video";a.vendorCRCode="AOD60";a.refTagString="dp_vse_ibvc";a.refTagCR="dp_vse_ibcr";a.refTag3P="dp_vse_ib3p";return a}(),d={vars:{A:{},isMobile:!1,relatedVideosCarousel:null,newHref:"",newrefTag:"dp_vse_ib",activeVideoVoteContainer:null,sushiMetricsConfig:null,buildSushiPayload:null,videoVoteContainerFactory:null,voteCountsFetched:!1},resizeMobilePopover:function(){var a=d.vars.A.$,b=a(q).height(),c=a(".vse-airy-container").outerHeight(!0)+a(".immersive-view-back-button").outerHeight(!0)+
a(".vse-md-container").outerHeight(!0),e=a(".vse-mobile-fixed-container").outerHeight(!0);a("#vse-ib-rv").css({"max-height":b-e,top:c})},resizeImmersiveView:function(){var a=d.vars.A.$("#ivVideoBlock"),b=d.vars.A.$("#ivVideosTab").height();a.css("height",b);var c=a.find(".vse-video-block"),e=b-d.getDimension(a,"padding-top")-d.getDimension(a,"padding-bottom");c.css({"max-height":b,overflow:"hidden"});b=a.find(".vse-airy-container");a=a.find(".vse-ib-metadata");e=Math.floor(e-d.getDimension(a,"height"));
c=Math.floor(e*t.WIDTH_ASPECT_RATIO);b.css({"max-height":e,"max-width":c});a.css("max-width",c);d.vars.isMobile&&d.resizeMobilePopover()},updateCustomerProfileAndReview:function(a){var b=d.vars.A.$(t.ibCarouselContainer).find('[data-asin\x3d"'+a.contentId+'"]'),c=d.vars.A.$(t.ibMetadata).find(".vse-md-customer-profile");d.vars.A.$(t.reviewStarContainer).children().remove();d.vars.A.$(t.reviewTextContainer).children().remove();if(b.find(".vse-review-stars").length){var e=b.find(".vse-review-stars").clone(),
h=b.find(".vse-review-text").clone();d.vars.A.$(t.reviewStarContainer).append(e);d.vars.A.$(t.reviewTextContainer).append(h)}0<b.find(".vse-video-customer-profile").length?(d.vars.A.$(t.ibMetadata).removeClass("vse-ib-profile-hidden"),c.children().remove(),a=b.find(".vse-video-customer-profile").clone().removeClass("aok-hidden vse-hidden"),c.append(a),c.find(".a-profile-avatar img").attr("src",b.find(".a-profile-avatar img").attr("data-src"))):(d.vars.A.$(t.ibMetadata).addClass("vse-ib-profile-hidden"),
d.vars.A.$(t.ibMetadata).find(".vse-md-vendor-name").text(a.vendorName.slice(3)));d.resizeImmersiveView()},updateMediaInfo:function(a){d.vars.A.$(t.videoInformationContainer).text(a.title);d.vars.A.$(t.ibMetadata).hasClass("vse-ib-customer-review")&&d.updateCustomerProfileAndReview(a);d.vars.videoVoteContainerFactory&&d.vars.videoVoteContainerFactory.videoVoteConfig&&!d.vars.videoVoteFailure&&(d.updateActiveVideoContainer(a.contentId,a.videoVoteContainer.getVoteCount(p.POSITIVE_VOTE),a.videoVoteContainer.getVoteCount(p.NEGATIVE_VOTE)),
d.fetchAndUpdateVotingHistory(),d.vars.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0))},updateActiveVideoContainer:function(a,b,c){d.vars.activeVideoVoteContainer.setContentId(a);d.vars.activeVideoVoteContainer.setVoteCount(p.POSITIVE_VOTE,b);d.vars.activeVideoVoteContainer.setVoteCount(p.NEGATIVE_VOTE,c);d.fetchAndUpdateVotingHistory()},castVote:function(a){if(d.vars.videoVoteContainerFactory&&d.vars.videoVoteContainerFactory.videoVoteConfig){var b=d.vars.activeVideoVoteContainer.getPreviousVote(),
c=a===p.POSITIVE_VOTE&&b!=p.POSITIVE_VOTE,b=a===p.NEGATIVE_VOTE&&b!=p.NEGATIVE_VOTE;d.vars.activeVideoVoteContainer.updateWithNewVote(a);d.vars.videoVoteContainerFactory.sendVoteToRemote(c,b,d.vars.activeVideoVoteContainer.getContentId()).then(function(b){d.vars.videoVoteContainerFactory&&d.vars.videoVoteContainerFactory.videoVoteConfig&&d.vars.A.trigger(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-cast",a)},function(b){N.count("ibiv.videovote.votecastfailure",1);d.vars.activeVideoVoteContainer.updateWithNewVote(a)})}},
getDimension:function(a,b){a=parseInt(a.css(b),10);return isNaN(a)?0:a},isDefined:function(a){return"undefined"!==typeof a&&null!==a},updateCERefTag:function(a){var b=a.find(".vse-video-item").data("vendorCode"),c=a.find(".vse-video-item").hasClass(t.ceVideoElement);a=a.find("a.vse-carousel-item");var e=a.attr("href");d.vars.newHref=e;b===t.vendorCRCode?(d.vars.newHref=e.replace(t.refTagString,t.refTagCR),d.vars.newrefTag=t.refTagCR):c&&b!==t.vendorCRCode&&(d.vars.newHref=e.replace(t.refTagString,
t.refTag3P),d.vars.newrefTag=t.refTag3P);a.attr("href",d.vars.newHref);a.attr("data-new-ref-tag",d.vars.newrefTag)},appendDivider:function(a,b){var c=d.vars.A.$(".vse-ib-dividerHeaderString").text()+(" ("+(b.length-a)+")");d.vars.A.$(".vse-ib-dividerHeaderString").text(c);c=d.vars.A.$(".recommended-videos-header");d.vars.A.$(b[a-1]).append(c);c.removeClass("aok-hidden")},fetchAndUpdateVotingHistory:function(){var a=d.vars.relatedVideosCarousel.getActiveAsset();a.videoVoteContainer.getPreviousVote()!==
p.EMPTY_VOTE?d.vars.activeVideoVoteContainer.setPreviousVote(a.videoVoteContainer.getPreviousVote()):d.vars.videoVoteContainerFactory.fetchVoteHistory(a.contentId).then(function(a){d.vars.videoVoteContainerFactory===n||a!==p.POSITIVE_VOTE&&a!==p.NEGATIVE_VOTE&&a!==p.NONE_VOTE||(d.vars.activeVideoVoteContainer.setPreviousVote(a),d.vars.A.trigger(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-history-set",a))},function(a){N.count("ibiv.videovote.votehistoryfailure",1)})}},kd=function(){function a(a,
c){this.brilaFactory=a;this.config=c}a.prototype.embed=function(){var a=this,c=document.getElementById(this.config.parentId),d=this.config.parentId+"-element",h=document.createElement("video");h.id=d;h.className="video-js";h.setAttribute("playsinline","true");this.config.shouldDisableControls||h.setAttribute("controls","true");this.config.shouldAutoplay&&h.setAttribute("autoplay","true");this.config.shouldStartMuted&&h.setAttribute("muted","true");c.appendChild(h);this.videoJS=this.brilaFactory.embed(d,
this.config);document.getElementById(d).setAttribute("style","width:100%; height:100%;");this.videoJS.src(this.config.mediaSourceInfo[0]);this.vseMetrics=this.brilaFactory.metrics(this.videoJS);this.config.videoAds.isEngineEnabled&&(this.vseAds=this.brilaFactory.ads(this.videoJS));this.videoJS.on("play",function(){a.config.bindings.play()});this.videoJS.on("firstplay",function(){a.config.bindings.play()});this.videoJS.on("fullscreenchange",function(){a.videoJS.isFullscreen()?a.config.bindings.fullscreen():
a.config.bindings.normalscreen()});return this.wrapper()};a.prototype.wrapper=function(){var a=this;return{attach:function(a){},isFullScreen:function(){return a.videoJS.isFullscreen()},enterFullScreen:function(){a.videoJS.requestFullscreen()},enterFullWindow:function(){a.videoJS.enterFullWindow()},enterNormalScreen:function(){a.videoJS.exitFullscreen()},play:function(c){d.isDefined(c)&&d.isDefined(c.eventTimestamp)&&a.vseMetrics.setPageLoadStartTimestamp(c.eventTimestamp);return a.videoJS.play()},
pause:function(){a.videoJS.pause()},loadMedia:function(c){var d=c.contentId;c=c.mediaSourceInfo[0];a.vseMetrics.setContentId(d);a.config.videoAds.isEngineEnabled&&a.vseAds.setContentId(d);a.videoJS.src(c)},destroy:function(){a.videoJS.dispose()}}};return a}();try{var md=function(a){return new a(function(a,c){w.when("A","a-carousel-framework","3p-promise","a-button","ready").register("VSECommonComponentAssets",function(c,h,k,g){var f,l,n,m,u,r,z,x=!1,B=!1,D=!1;d.vars.A=c;var C;d.vars.A.on("vseAiry",
function(){w.when("mash").execute("NilgiriService-Mash-Detection",function(a){d.vars.A.$(".vse-video-block").addClass("mshop");x=!0;m=a})});d.vars.A.on.orientationchange(function(a){if(0===a.orientation){a=a.height;var b=d.vars.A.$(".vse-mobile-fixed-container").outerHeight(!0);d.vars.A.$("#"+n).css({"max-height":a-b,top:b})}});return{initCarousel:function(){try{d.vars.A.state.parse();d.vars.A.state.replace("dp_vse_rvc",JSON.parse(d.vars.A.$("script[type\x3d'a-state'][data-a-state*\x3ddp_vse_rvc]").html()));
var a=d.vars.A.state("dp_vse_rvc");if(a){var b={gatedP:ib,_partial:xa,_keyBy:jd,EventEmitter:Lc,promise:k},g=new Pc(h,c,b);h.createAll();h.initializeAll();d.vars.relatedVideosCarousel=g.create(a);var m=c.$.extend({},a.videoVoteConfig);m.hasOwnProperty("placementContext")&&(m.dependencies=b,d.vars.videoVoteContainerFactory=new lb(c,m),d.vars.activeVideoVoteContainer=d.vars.videoVoteContainerFactory.createFromSelector("#vse-video-votes-lb-details-"+m.placementContext));n=a.carouselName;var u=d.vars.A.$(t.ibCarouselContainer).find("."+
t.ceVideoElement).parent("li");if(D=0<u.length){u.closest(t.ibCarouselContainer).addClass(t.ceVideoElement+"-container");z=d.vars.A.$(t.ibCarouselContainer+" ol.a-carousel li");var w=!1,x=0;u.each(function(a,b){d.vars.A.$(t.ibMetadata).addClass("vse-ib-customer-review");d.vars.A.$(b).css("border-bottom","none");d.updateCERefTag(d.vars.A.$(b));w||(w=!0,x=z.index(b),d.appendDivider(x,z))})}d.vars.A.on("vse:contentCarousel:"+n+":click",function(a){var b={mediaSourceInfo:[a.videoUrl],contentId:a.contentId};
if(d.isDefined(f)&&(f.attach(l),f.loadMedia(b),f.play({isAsync:!0,eventTimestamp:(new Date).getTime()}),d.updateMediaInfo(a),d.isDefined(r)&&r.setActiveVideoAndSource(a.contentId,a.vendorCode),D)){var b=d.vars.relatedVideosCarousel.findIndex(a),c=z.eq(b).find("a.vse-carousel-item").data("newRefTag");c&&d.vars.relatedVideosCarousel.emitRefTag(b,c,a)}});var y=d.vars.relatedVideosCarousel.getplaylist()[0];d.vars.relatedVideosCarousel.markPlaying(y);if(d.vars.videoVoteContainerFactory&&d.vars.videoVoteContainerFactory.videoVoteConfig&&
!D){d.vars.A.on(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-hide-votes",function(){d.vars.activeVideoVoteContainer.showOrHide(!1,!1,!1,!1);d.vars.videoVoteFailure=!0});d.vars.A.declarative(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-positive","click",function(){d.castVote(p.POSITIVE_VOTE)});d.vars.A.declarative(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-negative","click",function(){d.castVote(p.NEGATIVE_VOTE)});d.vars.A.on(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+
"-vote-cast",function(a){var b=a===p.POSITIVE_VOTE?p.NEGATIVE_VOTE:p.POSITIVE_VOTE,c=d.vars.relatedVideosCarousel.getActiveAsset(),e=p.EMPTY_VOTE;c&&c.videoVoteContainer&&(e=c.videoVoteContainer.getPreviousVote()===a?"cancel:"+a:c.videoVoteContainer.getPreviousVote()===p.POSITIVE_VOTE||c.videoVoteContainer.getPreviousVote()===p.NEGATIVE_VOTE?"switch-"+b+"-to-"+a:a,c.videoVoteContainer.updateWithNewVote(a));d.vars.sushiMetricsConfig&&d.vars.sushiMetricsConfig.endpoint!==t.EMPTY_STRING&&(a=d.vars.buildSushiPayload({eventName:"ibiv.videovote.castvote:"+
e,stringPayload:t.EMPTY_STRING,intPayload:1,videoAsin:c.contentId}),N.emitSushiMetric(a,d.vars.sushiMetricsConfig.endpoint));d.vars.A.on(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-history-set",function(a){var b=d.vars.relatedVideosCarousel.getActiveAsset();b&&b.videoVoteContainer.setPreviousVote(a)})});a=[];for(b=0;b<d.vars.relatedVideosCarousel.getplaylist().length;b++)a.push(d.vars.relatedVideosCarousel.getplaylist()[b].contentId);d.vars.videoVoteContainerFactory.fetchVoteCounts(a).then(function(a){d.vars.relatedVideosCarousel.updateVotingElements(a,
!1);d.vars.voteCountsFetched=!0;for(var b=d.vars.relatedVideosCarousel.getActiveAsset(),c,e=0;e<a.length;e++)if(a[e].contentId===b.contentId){c=a[e].positiveVoteCount;a=a[e].negativeVoteCount;d.updateActiveVideoContainer(b.contentId,c,a);break}d.vars.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0);d.resizeImmersiveView()},function(a){N.count("ibiv.videovote.votecountfailure",1);d.vars.A.trigger(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-hide-votes")})}}}catch(ld){q.ueLogError&&
q.ueLogError(ld,{logLevel:"FATAL",attribution:"vse-nilgiri-service",message:"InitializeVSECarousel: "})}},initPlayer:function(){try{var a=!1;d.vars.A.state.parse();d.vars.A.state.replace("vse_dp_airy",JSON.parse(d.vars.A.$("script[type\x3d'a-state'][data-a-state*\x3dvse_dp_airy]").html()));var b=d.vars.A.state("vse_dp_airy");if(b){C={onScreenChange:function(){a=!1;d.vars.A.trigger("vsePlayerScreenChange",a);x&&m&&m.dispatchEvent({type:"appOverlays.Show"})},onFullScreen:function(){a=!0;x&&m&&m.dispatchEvent({type:"appOverlays.Hide"})},
onPlay:function(){d.isDefined(f)&&"true"===e.enableFullScreenByDefault.toLowerCase()&&!f.isFullScreen()&&(f.enterFullScreen({isAsync:!0}),x&&m&&m.dispatchEvent({type:"appOverlays.Hide"}))}};var c=b.foresterConfiguration,e=b.playerConfiguration;d.vars.isMobile=b.isMobile;var g={contentId:c.contentId,customerId:b.sushiMetricsConfig.customerId,foresterMetadataParams:{client:c.client,marketplaceId:c.marketplaceId,method:c.method,requestId:c.requestId,session:c.sessionId},mediaSourceInfo:[b.videoUrl],
pageAsin:c.pageAsin,parentId:b.id,bindings:{play:function(){return C.onPlay()},normalscreen:function(){return C.onScreenChange()},fullscreen:function(){return C.onFullScreen()}}};b.sushiMetricsConfig&&b.sushiMetricsConfig.endpoint!==t.EMPTY_STRING&&(g.sushiMetricsConfig=b.sushiMetricsConfig);l=b.id;w.when("brila").execute("NS-Brila-Player",function(a){d.isDefined(f)&&"function"===typeof f.destroy&&f.destroy();var b=d.vars.A.$.extend({},g,{videoAds:{isEngineEnabled:!1},shouldStartMuted:!1,shouldAutoplay:!1,
shouldDisableControls:!1});f=(new kd(a,b)).embed();d.vars.A.trigger("vseAiry",{airy:f,containerId:l});d.vars.A.declarative("a-secondary-view","click touch",function(a){"video-immersive-view"===a.data.name&&d.isDefined(f)&&!f.isFullScreen()&&(u=d.vars.A.$("#image-block li .vse-video-element").closest("a.video-data-wrapper").data(),("true"===e.enableFullScreenByDefault.toLowerCase()||d.isDefined(u)&&1===u.videoCount)&&f.enterFullScreen())})});var k=d.vars.A.$("#div-feedback");d.vars.A.$(".vse-md-details").append(k);
var h=Kc.fetchLatestPageState(d.vars.A,"videoInformation-vse_ib_iv");h&&h.sushiMetricsConfig&&(d.vars.sushiMetricsConfig=h.sushiMetricsConfig,d.vars.buildSushiPayload=Jc.makeApplicationSushiPayloadBuilder(d.vars.A,d.vars.sushiMetricsConfig))}}catch(n){q.ueLogError&&q.ueLogError(n,{logLevel:"FATAL",attribution:"vse-nilgiri-service",message:"InitializePlayer: "})}},initFeedback:function(){try{var a=d.vars.A.$("#feedback-vse_ib_iv");d.vars.A.$("#div-relatedvideos").parent().parent().append(a.clone());
a.remove();r=(new Sc({A:c,buttonApi:g})).create("feedback-vse_ib_iv","feedback-vse_ib_iv");B||(d.vars.A.declarative("feedback-vse_ib_iv-trigger","click touch",function(a){d.vars.A.$("#feedback-vse_ib_iv").hasClass("active")?r.hideFeedbackForm():r.showFeedbackForm();d.vars.A.$("#feedback-vse_ib_iv").toggleClass("active")}),d.vars.A.on("vse:feedback-vse_ib_iv:feedback:hidden",function(){d.vars.A.$("#feedback-vse_ib_iv").removeClass("active")}),B=!0);var b=d.vars.A.state("vse_dp_airy").foresterConfiguration.contentId,
f=d.vars.A.state("vse_dp_airy").vendorCode;r.setActiveVideoAndSource(b,f)}catch(h){q.ueLogError&&q.ueLogError(h,{logLevel:"FATAL",attribution:"vse-nilgiri-service",message:"InitializeVSEFeedback: "})}},_noneFeature:a()}})})};w.when("A","3p-promise").execute("VSE-gatedP-register-ns-client",function(a,b){ib.register("VSECommonComponentAssets","VSE-NS-client-registered",md,b)})}catch(a){q.ueLogError&&q.ueLogError(a,{logLevel:"ERROR",attribution:"vse-nilgiri-service",message:"NSE: "})}})()});